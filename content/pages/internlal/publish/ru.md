title: Инструкция для Медиа
slug: publish
parent: documents
lang: ru
summary: Как публиковать новости на этом сайте

Для хостинга сайта мы используем GitHub, поскольку это бесплатный и надежный сервис. Есть разве что один минус — на нем нельзя скрыть, с какого аккаунта был опубликован тот или иной файл. Первоначально мы планировали решать эту проблему использованием одного общего аккаунта для всех выпускающих редакторов медиа, но эти планы были нарушены введением (абсолютно правильным, кстати) обязательной двухфакторной аутентификации. Поэтому теперь каждому выпускающему редактору придется работать с собственного аккаунта. Это, однако, все еще не проблема, поскольку GitHub не запрашивает никаких данных, позволяющих идентифицировать пользователя: для регистрации нужен только email, анонимизировать который не составляет труда.

## Первоначальная подготовка

1. Создайте новую электронную почту на сервисе, который не требует для регистрации контактных данных: например, [Tutanota](https://mail.tutanota.com/login) или [Proton mail](https://proton.me/ru/mail) (в обоих случаях бесплатного аккаунта более чем достаточно). Учтите, что это не одноразовый аккаунт — доступ к нему нужно будет сохранять. Ваше имя пользователя не должно никак на вас указывать: лучше всего сделать его случайным набором символов. Не используйте этот аккаунт ни для каких иных целей. И не забывайте про наши [инструкции по безопасности](/pages/passwords.html) при выборе пароля.
2. [Зарегистрируйтесь на GitHub](https://github.com/signup) при помощи созданной почты.
3. Отправьте тот же адрес электронной почты ответственному за поддержку сайта, указав, что вы выпускающий редактор медиа. Вам будут выданы необходимые права для редактирования сайта.
4. Установите приложение [GitHub Desktop](https://desktop.github.com/). При первом запуске приложение предложит вам войти в аккаунт GitHub — введите данные аккаунта, созданного на этапе 2.
5. После входа вам будут предложены варианты дальнейших действий, один из них — «Clone a repository from the Internet». Выберите его. В открывшемся окне выберите вкладку «URL». В поле для URL вставьте `https://github.com/marxunion/marxunion.github.io.git`. Локальную папку в втором поле можете выбирать по своему усмотрению. Затем нажмите «Clone».
6. В выбранной вами локальной папке появится копия всей структуры сайта СМ. Из нее вам нужна только папка `/content/posts` — там находятся статьи медиа. Посмотрите, как оформлены уже имеющиеся там статьи: вам надо будет делать то же самое.
7. Дождитесь получения прав на редактирования от ответственного за поддержку сайта. После этого можно начинать публиковать.

## Подготовка текста

Для публикации текст статьи должен быть подготовлен в [формате Markdown](https://gist.github.com/Jekins/2bf2d0638163f1294637). Для этого можно использовать встроенный редактор текстовых файлов в Nextcloud, который поддерживает этот синтаксис или любое из множества приложений с той же функцией, либо же просто форматировать текст вручную.

Метаданные текста необходимо внести в его преамбулу, которая должна располагаться в самом начале файла и иметь следующий вид:

```
title: Заголовок статьи
lang: ru
tags: тег1, тег2, тег3
slug: name
date: ДД-ММ-ГГГГ
summary: Краткое описание статьи
```

- `title` — заголовок статьи
- `lang` — язык статьи, который нужно указывать, поскольку у нас есть и переведенные страницы
- `tags` — теги, которые отображаются внизу статьи
- `slug` — кодовое название статьи, которое используется для создания ссылок; оно должно быть *уникальным* и состоять из латинских букв (или цифр) без пробелов
- `date` — дата публикации в формате ДД-ММ-ГГГГ
- `summary` — краткое описание публикации, используется для создания превью и в поисковых системах

Обратите внимание, что между строками преамбулы или до нее не должно быть пустых строк. Название самого файла может быть любым, но я предлагаю использовать код языка на случай, если в дальнейшем текст будет переводиться: например `ru.md`.

Каждая публикация должна сопровождаться хотя бы одним изображением — обложкой, которая будет использоваться на главной странице и на превью, а также будет добавлена перед текстом статьи. Это изображение должно находиться в одной папке с самим текстом и называться `cover` (разрешение файла не принципиально — это может быть jpg, png и т.д.). Идеальные размеры обложки — примерно 400 пикселей в высоту и 600 в ширину. Она не должна иметь слишком большой объем, поскольку тогда главная страница сайта будет загружаться долго.

В текст статьи можно добавлять дополнительные иллюстрации. Для этого соответствующее изображение (например `image.jpg`) нужно поместить в ту же папку и прикрепить его к тексту при помощи такой строки:

```![Описание изображения]({attach}image.jpg)```

Наконец, название папки, в которой вы собрали все эти файлы, должно совпадать со значением `slug` в преамбуле.

## Публикация

1. Для начала нужно актуализировать вашу локальную копию сайта. Для этого в GitHub Desktop нажмите на кнопку «Fetch origin» (сама правая на темной панели сверху), а затем, если появится такая опция — «Pull origin».
2. Откройте свою локальную копию и перейдите в ней в папку `/content/posts`. Скопируйте сюда папку с файлом статьи и иллюстрациями, которую подготовили в предыдущей части.
3. Снова откройте GitHub Desktop. В левой части приложения должны отобразиться внесенные вами изменения (если нет, то попробуйте перезапустить приложение). Под списком изменений будет форма. Заполните в ней поле «Summary» (можно вписать в него то же, что и в параметре `slug` публикуемой статьи). Затем нажмите «Commit».
4. Кнопка «Fetch origin» должна замениться на «Push origin». Нажмите на нее.
5. Готово! Через пару минут новая статья должна появиться на сайте.

